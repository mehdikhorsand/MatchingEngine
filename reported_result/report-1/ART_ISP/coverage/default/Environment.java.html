<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Environment.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MatchingEngine</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">Environment.java</span></div><h1>Environment.java</h1><pre class="source lang-java linenums">// total branches : 17
// never covered with valid orders : 0

<span class="fc" id="L4">public class Environment {</span>
    float ownership_upper_limit;
    int total_shares;
    float static_price_band_upper_limit;
    float static_price_band_lower_limit;
    int reference_price;
    int lot_size;
    int tick_size;

    @Override
    public String toString() {
<span class="fc" id="L15">        return &quot;\tReferencePrice\t&quot; + reference_price +</span>
                &quot;\n\tStaticPriceBandLowerLimit\t&quot; + static_price_band_lower_limit +
                &quot;\n\tStaticPriceBandUpperLimit\t&quot; + static_price_band_upper_limit +
                &quot;\n\tTotalShares\t&quot; + total_shares +
                &quot;\n\tOwnershipUpperLimit\t&quot; + ownership_upper_limit +
                &quot;\n\tTickSize\t&quot; + tick_size +
                &quot;\n\tLotSize\t&quot; + lot_size;
    }

    public void set_tick_size_rq(int tick_size) {
<span class="fc" id="L25">        this.tick_size = tick_size;</span>
<span class="fc" id="L26">    }</span>

    public void set_lot_size_rq(int lot_size) {
<span class="fc" id="L29">        this.lot_size = lot_size;</span>
<span class="fc" id="L30">    }</span>

    public void set_reference_price_rq(int reference_price) {
<span class="fc" id="L33">        this.reference_price = reference_price;</span>
<span class="fc" id="L34">    }</span>

    public void set_static_price_band_lower_limit_rq(float static_price_band_lower_limit) {
<span class="fc" id="L37">        this.static_price_band_lower_limit = static_price_band_lower_limit;</span>
<span class="fc" id="L38">    }</span>

    public void set_static_price_band_upper_limit_rq(float static_price_band_upper_limit) {
<span class="fc" id="L41">        this.static_price_band_upper_limit = static_price_band_upper_limit;</span>
<span class="fc" id="L42">    }</span>

    public void set_total_shares_rq(int total_shares) {
<span class="fc" id="L45">        this.total_shares = total_shares;</span>
<span class="fc" id="L46">    }</span>

    public void set_ownership_upper_limit_rq(float ownership_upper_limit) {
<span class="fc" id="L49">        this.ownership_upper_limit = ownership_upper_limit;</span>
<span class="fc" id="L50">    }</span>

    public boolean validate_order_price_limit(Order order) {
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">        if(order.price % tick_size == 0) {</span>
<span class="fc" id="L54">            int lower_price_limit = reference_price - (int)(reference_price * static_price_band_lower_limit);</span>
<span class="fc" id="L55">            int upper_price_limit = reference_price + (int)(reference_price * static_price_band_upper_limit);</span>
<span class="fc bfc" id="L56" title="All 4 branches covered.">            return lower_price_limit &lt;= order.price &amp;&amp; order.price &lt;= upper_price_limit;</span>
        }
        else
<span class="nc" id="L59">            return false;</span>
    }

    public boolean validate_order_quantity_limit(Order order) {
<span class="pc bpc" id="L63" title="1 of 2 branches missed.">        if(order.quantity % lot_size == 0) {</span>
<span class="fc bfc" id="L64" title="All 2 branches covered.">            if (order.is_buy) {</span>
<span class="fc" id="L65">                int owned_qty = order.shareholder_id.ownership;</span>
<span class="fc" id="L66">                int booked_orders_qty = order.shareholder_id.booked_buy_orders_qty;</span>
<span class="fc" id="L67">                int max_ownership = (int) (total_shares * ownership_upper_limit);</span>
<span class="fc bfc" id="L68" title="All 2 branches covered.">                return owned_qty + order.quantity + booked_orders_qty &lt; max_ownership;</span>
            }
            else
<span class="fc" id="L71">                return true;</span>
        }
        else
<span class="nc" id="L74">            return false;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>